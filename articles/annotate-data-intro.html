<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Introduction to utils for annotating data • nfportalutils</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to utils for annotating data">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">nfportalutils</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.9600</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/annotate-data-intro.html">Introduction to utils for annotating data</a></li>
    <li><a class="dropdown-item" href="../articles/annotate-nf-processed-data.html">Annotating nextflow processed data</a></li>
    <li><a class="dropdown-item" href="../articles/bringing-portal-data-to-other-platforms-cbioportal.html">Bringing Portal Data to Other Platforms: cBioPortal</a></li>
    <li><a class="dropdown-item" href="../articles/revalidation-workflows.html">Revalidation workflows</a></li>
    <li><a class="dropdown-item" href="../articles/survey-public-files.html">Surveying public files in the portal</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/nf-osi/nfportalutils/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Introduction to utils for annotating data</h1>
            
            <h4 data-toc-skip class="date">2022-10-17</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/nf-osi/nfportalutils/blob/develop/vignettes/annotate-data-intro.Rmd" class="external-link"><code>vignettes/annotate-data-intro.Rmd</code></a></small>
      <div class="d-none name"><code>annotate-data-intro.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="intro">Intro<a class="anchor" aria-label="anchor" href="#intro"></a>
</h2>
<p>This introduces the annotation utilities with typical examples. This is expected to be the more useful starting point for using nfportalutils for annotation tasks, to be followed by the more specialized vignetted for annotating NF processed data if needed.</p>
<div class="section level3">
<h3 id="set-up">Set up<a class="anchor" aria-label="anchor" href="#set-up"></a>
</h3>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/nf-osi/nfportalutils" class="external-link">nfportalutils</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/syn_login.html">syn_login</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Change this to a dev project you have access to  </span></span>
<span><span class="va">PROJECT</span> <span class="op">&lt;-</span> <span class="st">"syn26462036"</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="set-annotations-on-a-single-file">Set annotations on a single file<a class="anchor" aria-label="anchor" href="#set-annotations-on-a-single-file"></a>
</h3>
<p>Create a demo entity.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">synapseclient</span> <span class="op">&lt;-</span> <span class="fu">reticulate</span><span class="fu">::</span><span class="fu"><a href="https://rstudio.github.io/reticulate/reference/import.html" class="external-link">import</a></span><span class="op">(</span><span class="st">"synapseclient"</span><span class="op">)</span></span>
<span><span class="co"># Create an entity with some initial annotations</span></span>
<span><span class="va">entity</span> <span class="op">&lt;-</span> <span class="va">synapseclient</span><span class="op">$</span><span class="fu">Folder</span><span class="op">(</span><span class="st">"Demo Entity"</span>,</span>
<span>                               parent <span class="op">=</span> <span class="va">PROJECT</span>,</span>
<span>                               annotations <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>foo <span class="op">=</span> <span class="st">"bar"</span>, favorites <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"raindrops"</span>, <span class="st">"whiskers"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">entity</span> <span class="op">&lt;-</span> <span class="va">.syn</span><span class="op">$</span><span class="fu">store</span><span class="op">(</span><span class="va">entity</span><span class="op">)</span></span></code></pre></div>
<p><code>set_annotations</code> can be used to add new annotations or correct an existing annotation on an entity. This wraps the Python client to make it more intuitive to pass in an R list as the annotations as above. Here, add another annotation <em>and</em> correct the <code>favorites</code> to “chocolate”. The returned data shows the unchanged <code>foo</code>, the updated <code>favorites</code>, and a new <code>n</code>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/set_annotations.html">set_annotations</a></span><span class="op">(</span>id <span class="op">=</span> <span class="va">entity</span><span class="op">$</span><span class="va">properties</span><span class="op">$</span><span class="va">id</span>, annotations <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>favorites <span class="op">=</span> <span class="st">"chocolate"</span>, n <span class="op">=</span> <span class="fl">7L</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Cleanup.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">.syn</span><span class="op">$</span><span class="fu">delete</span><span class="op">(</span><span class="va">entity</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="annotate-in-batch-using-a-manifest">Annotate in batch using a manifest<a class="anchor" aria-label="anchor" href="#annotate-in-batch-using-a-manifest"></a>
</h3>
<p>A better way to use <code>set_annotations</code> for a set of entities, usually files.</p>
<p>First create multiple entities that need to be annotated or corrected in batch.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">objs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make_folder.html">make_folder</a></span><span class="op">(</span>parent <span class="op">=</span> <span class="va">PARENT_TEST_PROJECT</span>, folders <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mock_file_1"</span>, <span class="st">"mock_file_2"</span>, <span class="st">"mock_file_3"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">ids</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">objs</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">$</span><span class="va">properties</span><span class="op">$</span><span class="va">id</span><span class="op">)</span></span></code></pre></div>
<p>Create example manifest. Note: Another way includes reading in a shematic csv manifest with entityIds and Filenames.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">manifest</span> <span class="op">&lt;-</span> <span class="fu">data.table</span><span class="op">(</span></span>
<span>     entityId <span class="op">=</span> <span class="va">ids</span>,</span>
<span>     assay <span class="op">=</span> <span class="st">"drugScreen"</span>,</span>
<span>     experimentalTimepoint <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1L</span>, <span class="fl">3L</span>, <span class="fl">7L</span><span class="op">)</span>,</span>
<span>     experimentalTimepointUnit <span class="op">=</span> <span class="st">"days"</span>,</span>
<span>     cellType <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"schwann"</span>, <span class="st">"macrophage"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"schwann"</span>, <span class="st">"macrophage"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"schwann"</span>, <span class="st">"macrophage"</span><span class="op">)</span><span class="op">)</span></span>
<span>   <span class="op">)</span></span>
<span><span class="va">manifest</span></span></code></pre></div>
<p>Apply:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/annotate_with_manifest.html">annotate_with_manifest</a></span><span class="op">(</span><span class="va">manifest</span><span class="op">)</span></span></code></pre></div>
<p>Cleanup.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">for</span> <span class="op">(</span><span class="va">id</span> <span class="kw">in</span> <span class="va">ids</span><span class="op">)</span> <span class="va">.syn</span><span class="op">$</span><span class="fu">delete</span><span class="op">(</span><span class="va">id</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Robert Allaway, Anh Nguyet Vu.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
